# Описание проекта: телекоммуникации
Оператор связи «Ниединогоразрыва.ком» хочет научиться прогнозировать отток клиентов. Если выяснится, что пользователь планирует уйти, ему будут предложены промокоды и специальные условия. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и договорах.

Необходимо предсказать ухода клиента – отказ от продолжения пользования услугами, предоставляемыми заказчиком.
Основное пожелание заказчика – снизить убытки, связанные с неэффективными акциями по удержанию клиентов с помощью промо-купонов, скидок и прочих пакетов стимулирования.

Так, маркетологи компании выделяют две болевые точки:
<br /> 1) пользователю предложили промокоды, но он не собирался уходить (False Positive);
<br /> 2) пользователю ничего не предложили и он ушёл (False Negative).
<br /> После разработки модели заказчик хочет получить интерпретацию её работы (график ROC, матрица ошибок, важность признаков). 
- Основная метрика: ROC-AUC – для выдерживания баланса между false Positive и false Negative. 
- Дополнительная метрика: accuracy – для интерпретации (с матрицами ошибок).
- Минимальный порог хорошей модели: ROC-AUC >= 0.85

# Описание данных
Оператор предоставляет два основных типа услуг: 
- Стационарную телефонную связь. Возможно подключение телефонного аппарата к нескольким линиям одновременно.
- Интернет. Подключение может быть двух типов: через телефонную линию (DSL, от англ. digital subscriber line, «цифровая абонентская линия») или оптоволоконный кабель (Fiber optic).

# План работы
1) составление описания проекта
2) обзор данных
3) предобработка данных
<br/> 3.1. изменение типов данных
<br/> 3.2. заполнение пропусков
<br/>3.3. составление новых признаков на основе имеющихся
4) исследование данных - составление корреляционой матрицы и анализ распредления важнейших для целевого показателя признаков 
5) отбросить неважные для моделей признаки на основе матрицы корреляции (тут вопрос: насколько низкой должна быть корреляция, чтобы мы могли судить о том, что признак не повлияет на результат модели)
6) разделение данных на тренировочную и тестовую выборки
7) кодирование категориальных значений + масштабирование данных
8) обучение моделей (логистическая регрессия, случайный лес, бустинг) с использованием гридсерча и пайплайна с указанием параметра class_weight=‘balanced’ 
9) выбор лучшей модели по метрике roc-auc, проверка только этой модели на тестовой выборке+проверка ее метрики "accuracy" 
10) интерпретация результатов: ROC-кривая, матрица ошибок, анализ важности признаков (анализ важности признаков, получается, несколько дублирует то, что мы делаем в EDA? там ведь тоже после матрицы корреляции изучали некоторые признаки)
11) составлене отчета

## Отчет
Целью работы является  предсказать ухода клиента – отказ от продолжения пользования услугами, предоставляемыми заказчиком.
Основное пожелание заказчика – снизить убытки, связанные с неэффективными акциями по удержанию клиентов с помощью промо-купонов, скидок и прочих пакетов стимулирования.

Работа была выполнена в соответствии с ранее обозначиным планом, ни один этап не был пропущен:

### **Предобработка**:
- путем объединения 4 таблиц получили датасет на 7043 строк. 
- изменены форматы данных в столбцах TotalCharge, BeginDate, EndDate
- заполнены пропуски в категориальных призанаках "заглушкой" no_intenet и no_phone (в стобцах связанных с интернетом и с телефонией соответственно)
- cформированы новые признаки с информацией о количестве дней от начала контракта (duration), и о том, какой услугой пользуется клиент: признаки "Internet" и "Phone" с Yes/Nо в качестве данных

**Вывод по этапу работы**: оператору стоить обратить внимание на форматы данных, в которых они записываются, в будущем это может помочь их собственным аналитикам в построении отчетов и анализе поступающей информации. 

### **EDA**:
- после построяния корреляционной матрицы проанализировано распределение наиболее коррелирующих с целевым признаком признаков и сделаны слудющие выводы: 
- на основе матрицы корреляции перед подачей в модель были удалены мультиколлинеарные признаки (что в будущем позитивно повлияло на предсказания модели): 'OnlineSecurity', 'OnlineBackup', 'DeviceProtection', 'TechSupport', 'StreamingTV', 'StreamingMovies', 'InternetService'
- отброшены наименее коррелирующие признаки с целевой переменной, так как: 'phone', 'gender', 'Dependents'

**Вывод по этапу работы**: оператору стоит рассмотреть сбор другой, новой инофрмации о клиентах, для формаирования еще большего количества признаков для улучшения качества будущей модели. Кроме того в будущем стоит предоставить больше информации о тех клиентах, которые уже ушли от заказчика (на данный момент, подобных записй крайне мало).
Так же ниже представлено анализ распределения наиболее коррелирующих признаков с целевым: 

**1)** Наличие партнера больше характерно для клиентов, которые уже не пользуются услугами оператора связи «Ниединогоразрыва.ком». Так же можно заметить, что Electronic Check самы популярный способ оплаты у обеих групп клиентов, однако остальные значения данного признака разняться: у бывших клиентов способ оплаты credit card (automatic) является таким же популярным как и bank transfer, в то время как у нынешних клиентов наиболее популярен  способ оплаты через mailed check. 
  <br />  Оператору связи стоит обратить внимание на эту закономерность и разобрать преимущества и недостатки для их клиентов различных способах оплаты (особенно пристально советую рассмотреть mailed check.
<br />  **2)** Рассматривая распределение платы за месяц можно заметить что у нынешних клиентов плата за месяц меньше чем у тех, что престали таоквыми быть, что может быть связано как с уменьшением количества испольуемых услуг, так и с понижением цен. По графику распределения продолжительности пользования услугами оператора связи можно сделать вывод о том, что распределение стало менее нормальным, нежели было до этого,то же самое можно сказать и об LTV.


### **Обучение моделей**:
- на кросс-валидации было обучено 3 модели: линеная регрессия, случайный лес, catboost
- наилучший результат показала модель бустинга. При ее обучении были подобраны следующие гипперпараметры: 'iterations', 'learning_rate', 'depth' и 'l2_leaf_reg'. 
<br /> Наилучший результат roc_auc на тренировочной выборке равныый 0.8874 данная модель показала при следующих значениях гипперпараметров: 'depth': 6, 'iterations': 200, 'l2_leaf_reg': 1, 'learning_rate': 0.1.
<br />Эта же модель при тестировании на новой для нее тестовой выборке показала результат roc_auc равный 0.8874 и accuracy= 0.8915.
- В последствии были проанализированы матрица ошибок, рассмотрены наиболее значимые для модели признаки, построена roc-кривая.

**Вывод по этапу работы**: При анализе значимостипризнаков самым важным признаком для модели, оказалось количество проведённых клиентом дней в компании. Вторым по важности фактором является то, сколько клиент тратит на услуги ежемесячно и тип договора: ежемесячный, годовой и т.д. Наименее важными признаками являются наличие у клиента пенсионного статуса, факт выставления счёта по электронной почте. 

### Общий вывод по работе
Была проведена предобработка датасета на 7043 строк, удалены лишний признаки для подачи в модель. После обучения на кросс-валидации 3-х моделей наилучшей оказалась модель CatBoostClassifier, показавшая результат выше указанных заказчиком метрик.







